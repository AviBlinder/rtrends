{
    "collab_server" : "",
    "contents" : "#' @title CRAN Stats for single package\n#' @author Avi Blinder\n#' @description Download CRAN data related to several packages in a range of dates\n#' @param from_date  Starting date for downloading CRAN Repositories\n#' @param to_date  end date for downloading CRAN Repositories\n#' @param sel_package_name  Single package name for analysis\n#' @export\n\ncran_stats_by_package <- function(from_date,to_date,sel_package_name){\n\n  ##\n  start_date <- lubridate::ymd(from_date)\n  end_date <- lubridate::ymd(to_date)\n\n  all_days <- seq(start_date, end_date, by = 'day')\n  years <- lubridate::year(all_days)\n\n  urls <- paste0('http://cran-logs.rstudio.com/', years, '/', all_days, '.csv.gz')\n\n  package_stats <- c()\n  for (i in 1:length(urls)) {\n    stats_df <- c()\n    tmp <- tempfile()\n    download.file(urls[i], tmp)\n    unzipped_file <- read.csv( gzfile(tmp), sep=\"\\t\",header=TRUE,\n                               stringsAsFactors=FALSE)\n    rm(tmp)\n    #\n    names(unzipped_file) <- \"ConcatCol\"\n    unzipped_file_df <- tidyr::separate(unzipped_file,'ConcatCol',sep = \",\",\n                                 into = c(\"date\",\"time\",\"size\",\"r_version\",\"r_arch\",\"r_os\",\n                                          \"package_name\",\"package_version\",\"country\",\"ip_id\"))\n    unzipped_file_df_pck <- subset(unzipped_file_df,unzipped_file_df$package_name == sel_package_name)\n    package_stats <- rbind(package_stats,unzipped_file_df_pck)\n  }\n  package_stats\n}\n######################################################################################\n#' @return A dataframe with log date of a full date\n#' @title CRAN Stats for a specific date\n#' @author Avi Blinder\n#' @description Download a full CRAN Log for a specific date\n#' @param Date date of CRAN log to be downloaded\n#' @export\n#'\n\ncran_stats_by_day <- function(Date){\n\n  start <- lubridate::ymd(Date)\n\n\n  ##Create regex for package name\n  urls <- paste0('http://cran-logs.rstudio.com/',\n                 lubridate::year(start), '/', start, '.csv.gz')\n\n  package_stats <- c()\n  stats_df <- c()\n  tmp <- tempfile()\n  download.file(urls, tmp)\n  unzipped_file <- read.csv( gzfile(tmp), sep=\"\\t\",header=TRUE,\n                             stringsAsFactors=FALSE)\n  rm(tmp)\n  #remove header\n  names(unzipped_file) <- \"ConcatCol\"\n  unzipped_file_df <- tidyr::separate(unzipped_file,'ConcatCol',sep = \",\",\n                               into = c(\"date\",\"time\",\"size\",\"r_version\",\"r_arch\",\"r_os\",\n                                        \"package_name\",\"package_version\",\"country\",\"ip_id\"))\n}\n#######################################################################################\n#' @return dataframe with log information\n#' @title CRAN Stats for several packages\n#' @author Avi Blinder\n#' @description Download CRAN log data related to several packages in\n#' a range of dates\n#' @param from_date  Starting date for downloading CRAN Repositories\n#' @param to_date  end date for downloading CRAN Repositories\n#' @param sel_package_name  Single package name for analysis\n#' @export\n#'\ncran_stats_by_packages <- function(from_date,to_date,sel_package_name){\n\n\n  ##\n  start_date <- lubridate::ymd(from_date)\n  end_date <- lubridate::ymd(to_date)\n\n  all_days <- seq(start_date, end_date, by = 'day')\n  years <- lubridate::year(all_days)\n\n  urls <- paste0('http://cran-logs.rstudio.com/', years, '/', all_days, '.csv.gz')\n\n  package_stats <- c()\n  for (i in 1:length(urls)) {\n    stats_df <- c()\n    tmp <- tempfile()\n    download.file(urls[i], tmp)\n    unzipped_file <- read.csv( gzfile(tmp), sep=\"\\t\",header=TRUE,\n                               stringsAsFactors=FALSE)\n    rm(tmp)\n    #\n    names(unzipped_file) <- \"ConcatCol\"\n    unzipped_file_df <- tidyr::separate(unzipped_file,'ConcatCol',sep = \",\",\n                                 into = c(\"date\",\"time\",\"size\",\"r_version\",\"r_arch\",\"r_os\",\n                                          \"package_name\",\"package_version\",\"country\",\"ip_id\"))\n    unzipped_file_df_pck <- subset(unzipped_file_df,unzipped_file_df$package_name %in% sel_package_name)\n    package_stats <- rbind(package_stats,unzipped_file_df_pck)\n  }\n  package_stats\n}\n",
    "created" : 1480447949551.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "422560521",
    "id" : "C9CC1B00",
    "lastKnownWriteTime" : 1480448516,
    "last_content_update" : 1480448516720,
    "path" : "D:/DataScienceProjects/R_Packages/rtrends/R/rtrends.r",
    "project_path" : "R/rtrends.r",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}